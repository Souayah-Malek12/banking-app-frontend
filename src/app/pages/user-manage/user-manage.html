<div *ngIf="loading">Loading...</div>
<div *ngIf="error" class="error">{{ error }}</div>

<!-- Ensure user exists first -->
<div *ngIf="!loading && !error && user">

  <!-- User Info -->
  <div class="user-info" *ngIf=" !loading && !error && user">
    <h2>{{ user.fullName }}</h2>
    <h1><button (click)="deleteAccount(user.id)">Delete User</button></h1>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><strong>Phone:</strong> {{ user.phoneNumber }}</p>
    <p><strong>Address:</strong> {{ user.address }}</p>
    <p><strong>Role:</strong> {{ user.role }}</p>
  </div>

  <!-- Accounts Table -->
  <div *ngIf="user.accounts && user.accounts.length > 0; else noAccounts">
    <h3>Accounts</h3>
    <table class="accounts-table">
      <thead>
        <tr>
          <th>Account Holder</th>
          <th>Balance</th>
          <th>Account ID</th>
          <th>RIB</th>
          <th>Type</th>
          <th>Transactions</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let account of user.accounts; let i = index">
          <tr>
            <td>{{ account.accountHolderName }}</td>
            <td>{{ account.balance }}</td>
            <td>{{ account.id }}</td>
            <td>{{ account.rib }}</td>
            <td>{{ account.type }}</td>
            <td>

            </td>
          </tr>

          <!-- Transactions Table -->
          <tr >
            <td colspan="6">
              <table class="transactions-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Amount</th>
                    <th>Type</th>
                    <th>Timestamp</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let t of account.transactions">
                    <td>{{ t.id }}</td>
                    <td>{{ t.amount }}</td>
                    <td>{{ t.type }}</td>
                    <td>{{ t.timestamp }}</td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>

</div>

<!-- No Accounts Template -->
<ng-template #noAccounts>
  <p>No accounts found.</p>
</ng-template>
